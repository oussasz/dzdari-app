"use strict";exports.id=787,exports.ids=[787],exports.modules={8825:(e,t,r)=>{r.d(t,{default:()=>n});var a=r(10326);r(17577);var s=r(89254),i=r(90434),l=r(6162);let n=({title:e,subtitle:t,showReset:r})=>{let n=(0,l.T)("Empty"),d=e??n("noExactMatches"),o=t??n("tryChangeFilters");return(0,a.jsxs)("div",{className:" h-[60vh] flex flex-col gap-2 justify-center items-center",children:[a.jsx(s.Z,{center:!0,title:d,subtitle:o}),a.jsx("div",{className:"w-48 mt-4",children:r&&a.jsx(i.default,{href:"/",className:"bg-white border-[1px] border-gray-500 text-[#4e4e4e] rounded hover:opacity-80 transition ",children:n("removeAllFilters")})})]})}},82005:(e,t,r)=>{r.d(t,{default:()=>x});var a=r(10326),s=r(17577),i=r(67765),l=r(40381),n=r(45204),d=r(97964),o=r.n(d),c=r(77109),u=r(52117);r(15424);var f=r(46242);(0,f.$)("001837c49f82a4a4d75b3dc0964dc6c76e2d2b77"),(0,f.$)("c1a53f0f37ee773167b45a3bf6a61b76eb07c326");var p=(0,f.$)("ab224d6a6aaea9fdd9ddb9b9a8c9dad0cd2e02f8");let x=({listingId:e,hasFavorited:t})=>{let{status:r}=(0,c.useSession)(),[d,f]=(0,s.useState)(t),x=(0,s.useRef)(t),{mutate:m}=(0,n.D)({mutationFn:p,onError:()=>{x.current=!x.current,f(x.current),l.Am.error("Failed to favorite")}}),h=o()(()=>{m({listingId:e,favorite:x.current})},300),g=(0,s.useCallback)(()=>{h()},[]);return(0,a.jsxs)("button",{type:"button",onClick:e=>{if(e.stopPropagation(),e.preventDefault(),"authenticated"!==r){l.Am.error("Please sign in to favorite the listing!");return}g(),f(e=>!e),x.current=!x.current},className:" relative hover:opacity-80 transition cursor-pointer z-[5] ",children:[a.jsx(i.lo,{size:28,className:"   text-gray-50   absolute   -top-[2px]   -right-[2px]   "}),a.jsx(i.M_L,{size:24,className:(0,u.cn)(d?"fill-rose-500":"fill-neutral-500/70")})]})}},10307:(e,t,r)=>{r.d(t,{default:()=>n});var a=r(10326),s=r(17577),i=r(46226),l=r(52117);let n=({imageSrc:e,fill:t=!1,alt:r,className:n,priority:d=!1,effect:o,sizes:c})=>{let[u,f]=(0,s.useState)(!1);return a.jsx(i.default,{fill:t,className:(0,l.cn)("transition duration-300","zoom"===o&&"scale-95",u?"opacity-100 scale-100":"opacity-0",n),src:e,alt:r,onLoad:()=>f(!0),priority:d,sizes:c,unoptimized:!0})}},54655:(e,t,r)=>{r.d(t,{T:()=>W,default:()=>O});var a=r(10326),s=r(17577),i=r(90434),l=r(3474),n=r(3778),d=r(34643),o=r(6162),c=r(82005),u=r(10307),f=r(52117),p=r(66373),x=r(35047),m=r(45204),h=r(40381),g=r(90329),b=r(60132),v=r(94752),y=r(97862),j=r(13192);let w=({title:e,onConfirm:t,onCloseModal:r,isLoading:s=!1})=>(0,a.jsxs)("div",{className:" flex flex-col gap-3 px-6 py-8 relative",children:[a.jsx("button",{type:"button",className:" p-1 border-0  hover:opacity-70 transition absolute right-3 top-3",onClick:()=>r?.(),children:a.jsx(v.QAE,{size:20})}),a.jsx("h1",{className:"text-[22px] font-bold text-gray-800",children:e}),a.jsx("p",{className:"text-gray-700  text-[16px] leading-[1.6] mb-4",children:"Are you sure you want to do this? It can't be undone."}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-1 h-[40px]",children:[a.jsx(y.Z,{onClick:()=>r?.(),className:"h-full",outline:!0,children:"Cancel"}),a.jsx(y.Z,{onClick:()=>{t(r)},className:"h-full flex items-center justify-center",children:s?a.jsx(j.Z,{}):a.jsx("span",{children:" Confirm"})})]})]});var N=r(30919),C=r(51327),Z=r(2209);let I={value:"DZ",label:"Algeria",flag:"\uD83C\uDDE9\uD83C\uDDFF"},E=e=>e?e.split(",").map(e=>e.trim()).filter(Boolean):[],D=e=>{if(!e)return"";let t=Z.find(t=>t?.nameFr===e||t?.nameAr===e);return t?.code??""},P=(e,t)=>{let r=(()=>{if(!e)return null;try{let t=JSON.parse(e);return Array.isArray(t)?t.map(e=>String(e)).filter(Boolean):null}catch{return null}})();return r&&r.length?r.slice(0,5):t?[t]:[]},S=({listingId:e,onCloseModal:t})=>{let[r,i]=(0,s.useTransition)(),[l,n]=(0,s.useState)(null);(0,s.useEffect)(()=>{i(async()=>{try{let t=await (0,C.Cy)(e),r=D(t.region),a=t.latitude,s=t.longitude,i="number"==typeof a&&"number"==typeof s;n({duration:t.duration??"",category:t.category??"",features:E(t.features),location:i&&t.region?{...I,label:t.country??I.label,region:t.region,latlng:[a,s]}:null,wilayaCode:r,municipality:t.municipality??"",address:t.address??"",guestCount:t.guestCount??1,bathroomCount:t.bathroomCount??1,roomCount:t.roomCount??1,images:P(t.images??null,t.imageSrc),price:null!=t.price?String(t.price):"",title:t.title??"",description:t.description??""})}catch(e){h.ZP.error(e?.message||"Failed to load listing"),t?.()}})},[e,t]);let d=(0,s.useMemo)(()=>(0,a.jsxs)("div",{className:"w-full h-full flex flex-col",children:[a.jsx(b.Z.WindowHeader,{title:"Edit property"}),a.jsx("div",{className:"p-6 flex items-center justify-center",children:a.jsx(j.Z,{})})]}),[]);return l?a.jsx(N.Z,{mode:"edit",listingId:e,initialValues:l,onCloseModal:t}):d};r(15424);var z=r(46242),$=(0,z.$)("db16f98a7dd509dc43fd9fb70035dab959baf639");(0,z.$)("cac5bff2370d361859fcb45ded3a18f9feb290ff"),(0,z.$)("578785c17f7947cb2d65472cb4242c57c8621203"),(0,z.$)("1106a624fc89780734d43596a1878891b0872f57"),(0,z.$)("84b639be183e082fba4d06c9dff2f39883927b92");var T=(0,z.$)("2ad9c02f7138be20aaff203fa989dbdd2c65d88f");let A={"/properties":"Delete property","/trips":"Cancel reservation","/reservations":"Cancel guest reservation"},F=e=>e?"/"===e?"/":e.replace(/\/+$/,""):"",L=({id:e})=>{let t=F((0,x.usePathname)()),r=t.endsWith("/favorites"),i=t.endsWith("/properties"),l=t.endsWith("/trips"),n=t.endsWith("/reservations"),d=i?A["/properties"]:l?A["/trips"]:n?A["/reservations"]:"",{mutate:o}=(0,m.D)({mutationFn:$}),{mutate:c}=(0,m.D)({mutationFn:T}),[u,f]=(0,s.useTransition)();return"/"!==t&&!r&&(i||l||n)?(0,a.jsxs)(b.Z,{children:[(0,a.jsxs)(g.Z,{children:[a.jsx(g.Z.Toggle,{id:"lisiting-menu",className:"w-10 h-10 flex items-center z-5 justify-center",children:a.jsx("button",{type:"button",className:"w-7 h-7 rounded-full bg-neutral-700/50 flex items-center justify-center hover:bg-neutral-700/70 group transition duration-200 z-[5]",children:a.jsx(p.evw,{className:"h-[18px] w-[18px] text-gray-300 transition duration-100 group-hover:text-gray-100 "})})}),(0,a.jsxs)(g.Z.List,{position:"bottom-left",className:"rounded-md",children:[i?a.jsx(b.Z.Trigger,{name:"edit-listing",children:a.jsx(g.Z.Button,{className:"text-[14px] rounded-md font-semibold py-[10px] hover:bg-neutral-100 transition",children:"Edit property"})}):null,a.jsx(b.Z.Trigger,{name:"confirm-delete",children:a.jsx(g.Z.Button,{className:"text-[14px] rounded-md font-semibold py-[10px] hover:bg-neutral-100 transition",children:d})})]})]}),i?a.jsx(b.Z.Window,{name:"edit-listing",children:a.jsx(S,{listingId:e})}):null,a.jsx(b.Z.Window,{name:"confirm-delete",children:a.jsx(w,{onConfirm:t=>{f(()=>{try{i?o(e,{onSuccess:()=>{t?.(),h.ZP.success("Listing successfully deleted!")}}):(l||n)&&c(e,{onSuccess:()=>{t?.(),h.ZP.success("Reservation successfully cancelled!")}})}catch(e){h.ZP.error("Oops! Something went wrong. Please try again later."),t?.()}})},title:d,isLoading:u})})]}):null};var M=r(63347);let O=({data:e,reservation:t,hasFavorited:r})=>{let s;let n=(0,d.bU)(),p=(0,o.T)("Listing"),x=(0,o.T)("PurposeOptions"),m=t?t.totalPrice:e?.price;if(t){let e=new Date(t.startDate),r=new Date(t.endDate);s=`${(0,l.WU)(e,"PP")} - ${(0,l.WU)(r,"PP")}`}let h=(()=>{let t=M.KP.find(t=>t.label===e.category);return t?x(`${t.id}.label`):e.category})(),g=(()=>{let t=e.images;if("string"==typeof t&&t)try{let e=JSON.parse(t);if(Array.isArray(e)&&e.length&&"string"==typeof e[0])return e[0]}catch{}return e.imageSrc})(),b=()=>{let t=e.duration;if(!t)return null;let r=M.z3.find(e=>e.id===t||e.label===t);return r?.id??null};return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:"absolute top-0 left-0 p-3 flex items-center justify-between w-full",children:[a.jsx("div",{className:"z-5",children:a.jsx(L,{id:t?.id||e.id})}),a.jsx("div",{className:"w-[28px] h-[28px] flex items-center justify-center",children:a.jsx(c.default,{listingId:e.id,hasFavorited:r},e.id)})]}),a.jsx(i.default,{href:`/listings/${e.id}`,className:"col-span-1 cursor-pointer",children:(0,a.jsxs)("div",{className:"flex flex-col gap-1 w-full",children:[a.jsx("div",{className:" overflow-hidden md:rounded-xl rounded-md",children:a.jsx("div",{className:"aspect-[1/0.95] relative bg-gray-100",children:a.jsx(u.default,{imageSrc:g,fill:!0,alt:e.title,effect:"zoom",className:"object-cover",sizes:"100vw"})})}),(0,a.jsxs)("span",{className:"font-semibold text-[16px] mt-[4px]",children:[e?.region,", ",e?.country]}),a.jsx("span",{className:"font-light text-neutral-500 text-sm",children:s||h}),(0,a.jsxs)("div",{className:"flex flex-row items-baseline gap-1",children:[(0,a.jsxs)("span",{className:"font-bold text-[#444] text-[14px]",children:["DZD ",(0,f.T)(m,n)]}),!t&&(0,a.jsxs)("span",{className:"font-light",children:["/ ",(()=>{switch(b()){case"byNight":default:return p("night");case"perWeek":return p("week");case"perMonth":return p("month");case"per3Months":return p("threeMonths");case"perYear":return p("year");case"longTerm":return p("longTerm")}})()]})]})]})})]})},W=()=>a.jsx("div",{className:"col-span-1 ",children:(0,a.jsxs)("div",{className:"flex flex-col gap-1 w-full",children:[a.jsx(n.Z,{width:"100%",height:"100%",borderRadius:"12px",className:"aspect-square"}),(0,a.jsxs)("div",{className:"flex flex-row gap-3",children:[a.jsx(n.Z,{height:"18px",width:"84px"}),a.jsx(n.Z,{height:"18px",width:"84px"})]}),a.jsx(n.Z,{height:"16px",width:"102px"}),a.jsx(n.Z,{height:"18px",width:"132px"})]})})},71539:(e,t,r)=>{r.d(t,{Z:()=>a});let a=(0,r(68570).createProxy)(String.raw`/home/oussasz/Project/Dz Dari/lugario/components/EmptyState.tsx#default`)},79687:(e,t,r)=>{r.d(t,{Z:()=>s});var a=r(68570);let s=(0,a.createProxy)(String.raw`/home/oussasz/Project/Dz Dari/lugario/components/ListingCard.tsx#default`);(0,a.createProxy)(String.raw`/home/oussasz/Project/Dz Dari/lugario/components/ListingCard.tsx#ListingSkeleton`)},41183:(e,t,r)=>{r.r(t),r.d(t,{$$ACTION_0:()=>o,$$ACTION_1:()=>u,$$ACTION_2:()=>p,getFavoriteListings:()=>f,getFavorites:()=>d,updateFavorite:()=>c});var a=r(24330);r(60166);var s=r(9487),i=r(84848),l=r(57708),n=r(40618);let d=(0,a.j)("573aee30d49bf9c1a8aea2c43b09b3a41110c6c2",o);async function o(){try{let e=await (0,i.t)();if(!e)return[];return(await s.db.favorite.findMany({where:{userId:e.id},select:{listingId:!0}})).map(e=>e.listingId)}catch(e){return[]}}let c=(0,a.j)("476c2e271afa7809c316ac65717a0cf700a3d3d8",u);async function u({listingId:e,favorite:t}){try{let r;if(!e||"string"!=typeof e)throw Error("Invalid ID");let a=await (0,i.t)();if(!a)throw Error("Please sign in to favorite the listing!");return t?(await s.db.favorite.upsert({where:{userId_listingId:{userId:a.id,listingId:e}},create:{userId:a.id,listingId:e},update:{}}),r=!0):(await s.db.favorite.deleteMany({where:{userId:a.id,listingId:e}}),r=!1),(0,l.revalidatePath)("/"),(0,l.revalidatePath)(`/listings/${e}`),(0,l.revalidatePath)("/favorites"),{hasFavorited:r}}catch(e){throw Error(e.message)}}let f=(0,a.j)("db2f0e26ed6c20fadfc94ebc5160fc769b450ad9",p);async function p(){try{let e=await (0,i.t)();if(!e)return[];return await s.db.listing.findMany({where:{favoritedBy:{some:{userId:e.id}}}})}catch(e){throw Error(e.message)}}(0,n.h)([d,c,f]),(0,a.j)("c1a53f0f37ee773167b45a3bf6a61b76eb07c326",d),(0,a.j)("ab224d6a6aaea9fdd9ddb9b9a8c9dad0cd2e02f8",c),(0,a.j)("001837c49f82a4a4d75b3dc0964dc6c76e2d2b77",f)},10692:(e,t,r)=>{r.d(t,{t:()=>u});var a=r(43153),s=r(67096),i=r.n(s),l=r(12458),n=r(34413),d=r(85876),o=r(88296);let c={adapter:(0,l.N)(o.db),providers:[(0,d.Z)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET}),(0,n.Z)({name:"credentials",credentials:{email:{label:"email",type:"text"},password:{label:"password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)throw Error("Invalid credentials");let t=await o.db.user.findUnique({where:{email:e.email}});if(!t||!t?.password||!await i().compare(e.password,t.password))throw Error("Invalid credentials");return t}})],callbacks:{session:async({token:e,session:t})=>(e&&(t.user.id=e.id,t.user.name=e.name,t.user.email=e.email),t),jwt:async({token:e,user:t})=>t?{...e,...t}:e},pages:{signIn:"/"},session:{strategy:"jwt"},secret:process.env.NEXTAUTH_SECRET},u=async()=>{let e=await (0,a.getServerSession)(c);return e?.user}},33408:(e,t,r)=>{r.d(t,{UM:()=>i});var a=r(73997),s=r(58544);a.Paj,a.f$3,a.sHf,a.sHf,a.dKE,a.dKE,a.Yfi,a.KfF,a.Nzl,a.eAf,a.Yqy,a.jsv,a.I4E,a.rhR,a.vc9,s.Q7H,a.Ys1,a.IB_,a.bVG,a.yEz,a.XG1,a.eVG,a.WKE,a.h9I,a.fC4;let i=16},57481:(e,t,r)=>{r.r(t),r.d(t,{default:()=>s});var a=r(66621);let s=e=>[{type:"image/x-icon",sizes:"256x256",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};